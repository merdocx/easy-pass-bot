[tool:pytest]
# Конфигурация pytest для Easy Pass Bot

# Директории для поиска тестов
testpaths = tests

# Паттерны для поиска тестовых файлов
python_files = test_*.py *_test.py

# Паттерны для поиска тестовых классов
python_classes = Test*

# Паттерны для поиска тестовых функций
python_functions = test_*

# Минимальная версия Python
minversion = 3.8

# Добавляем src в путь для импортов
pythonpath = src

# Асинхронные тесты
asyncio_mode = auto

# Маркеры тестов
markers =
    unit: Unit тесты
    integration: Интеграционные тесты
    e2e: End-to-end тесты
    performance: Тесты производительности
    security: Тесты безопасности
    slow: Медленные тесты

# Фильтры предупреждений
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning:aiogram.*

# Настройки покрытия
addopts = 
    --strict-markers
    --strict-config
    --verbose
    --tb=short
    --cov=src/easy_pass_bot
    --cov-report=html:htmlcov
    --cov-report=term-missing
    --cov-report=xml
    --cov-fail-under=80

# Исключения из покрытия
omit = 
    src/easy_pass_bot/tests/*
    src/easy_pass_bot/*/tests/*
    src/easy_pass_bot/*/test_*
    src/easy_pass_bot/*/*_test.py
    src/easy_pass_bot/config.py
    src/easy_pass_bot/main.py

# Настройки логирования
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Настройки для параллельного выполнения
# -n auto для автоматического определения количества процессов
# -n 0 для отключения параллельного выполнения
# -n 4 для 4 процессов
# addopts = -n auto

# Настройки для профилирования
# addopts = --profile --profile-svg

# Настройки для отладки
# addopts = --pdb --pdbcls=IPython.terminal.debugger:Pdb

# Настройки для отчетов
# addopts = --html=report.html --self-contained-html

# Настройки для JUnit XML
# addopts = --junitxml=report.xml
