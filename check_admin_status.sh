#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –∞–¥–º–∏–Ω–∫–∏

echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∞–¥–º–∏–Ω–∫–∏ PM Desk"
echo "===================================="

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø—É—â–µ–Ω –ª–∏ –ø—Ä–æ—Ü–µ—Å—Å
if pgrep -f "start_admin.py" > /dev/null; then
    PID=$(pgrep -f "start_admin.py")
    echo "‚úÖ –ü—Ä–æ—Ü–µ—Å—Å –∞–¥–º–∏–Ω–∫–∏ –∑–∞–ø—É—â–µ–Ω (PID: $PID)"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
    echo "üìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:"
    ps -o pid,vsz,rss,pcpu,pmem,comm -p $PID | tail -1
else
    echo "‚ùå –ü—Ä–æ—Ü–µ—Å—Å –∞–¥–º–∏–Ω–∫–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω"
    exit 1
fi

echo ""

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ localhost
echo "üåê –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:"
if curl -s -o /dev/null -w "%{http_code}" http://localhost:8080/ | grep -q "200"; then
    echo "‚úÖ Localhost (http://localhost:8080) - –¥–æ—Å—Ç—É–ø–µ–Ω"
else
    echo "‚ùå Localhost (http://localhost:8080) - –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ –≤–Ω–µ—à–Ω–µ–º—É IP
if curl -s -o /dev/null -w "%{http_code}" http://89.110.96.90:8080/ | grep -q "200"; then
    echo "‚úÖ –í–Ω–µ—à–Ω–∏–π IP (http://89.110.96.90:8080) - –¥–æ—Å—Ç—É–ø–µ–Ω"
else
    echo "‚ùå –í–Ω–µ—à–Ω–∏–π IP (http://89.110.96.90:8080) - –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
fi

echo ""

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Ä—Ç
echo "üîå –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞ 8080:"
if netstat -tlnp | grep ":8080 " > /dev/null; then
    echo "‚úÖ –ü–æ—Ä—Ç 8080 —Å–ª—É—à–∞–µ—Ç—Å—è"
    netstat -tlnp | grep ":8080 "
else
    echo "‚ùå –ü–æ—Ä—Ç 8080 –Ω–µ —Å–ª—É—à–∞–µ—Ç—Å—è"
fi

echo ""
echo "üìù –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã):"
if [ -f "/root/easy-pass-bot/admin.log" ]; then
    tail -5 /root/easy-pass-bot/admin.log
else
    echo "   –õ–æ–≥ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi


